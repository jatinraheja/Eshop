{% extends 'base.html' %}
{% block title %} Cart {% endblock title %}
{% load cart %}
{% load custom_filter %}
{% block content %}
 <div class="container p-4 m-4">
 <div class="p-4 m-4 border rounded">
     <div class="text-center display-4 ml-4 pl-4 mb-4"><p>Your Cart<p></p></div>
     <hr/>
 <table class="table">
     <thead>
         <tr>
             <th>S.No</th>
             <th></th>
             <th>Product</th>
             <th>Product Name</th>
             <th>Quantity</th>
             <th>Price</th>
             <th>Total</th>
         </tr>
     </thead>
     <tbody>
     {% for cart in Cart %}
         <tr>
             <td>{{forloop.counter}}</td>
             <td colspan="2"><img class="rounded-circle" src="{{cart.product.image.url}}" width="150" /></td>
             <td>{{cart.product.name}}</td>
             {% comment %} <td>{{cart.quantity}} {% endcomment %}
             <td>
    <div class="row no-gutters">
    <form action="#{{cart.id}}" method="POST" class="col-2">
      {% csrf_token %}
      <input hidden type="text" class="form-control" name="cart" value={{cart.id}} placeholder="">
      <input hidden type="text" class="form-control" name="remove" value="True" placeholder="">
      <input type="submit" value="-" class="btn btn-block btn-secondary col"/>
    </form>
    <div class="text-center col">{{cart.quantity}}</div>
    <form action="#{{cart.id}}" method="POST" class="col-2">
      {% csrf_token %}
      <input hidden type="text" class="form-control" name="cart" value={{cart.id}} placeholder="">
      <input type="submit" value="+" class="btn btn-block btn-secondary col"/>
    </form>  
  </div>
             
             </td>
             <td>{{cart.product.price|currency_symbol}}</td>
             <td><p>{{cart.product|product_total_price:request.user.id}}</p>
              <form action="{% url 'cart' %}" method="post">
               {% csrf_token %}
                <p class="pt-4 mt-4">
                    <input hidden type="text" name="product_to_be_remove" id="product-remove" value="{{cart.id}}">
                    <input class="btn btn-danger btn-sm mt-4" type="submit" value="Remove" name="remove_product"></p>
              </form>
             </td>
            </tr>
      {% endfor %}   
     </tbody>
     <tfoot class="mt-3">
         <th colspan="3"></th>
          <th colspan="2" class="text-center">Total:</th>
         <th>{{Cart|total_cart_price:request.user.id}}</th>
     </tfoot>
 </table>
 </div>
 <div class="d-flex">
    <div class="col-9"></div> 
    <div class="col-3"><a href="" data-toggle="modal" data-target="#exampleModal" class="btn btn-outline-info border rounded col-12">Check Out</a>
 </div>
</div>

  
  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title text-center" id="exampleModalLabel">Check Out Form</h4>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
        <form action="/check-out" method="post">
            {% csrf_token %}
            <div class="form-group">
              <label for="address">Address</label>
              <input type="text" name="address" id="address" class="form-control" placeholder="" aria-describedby="helpId">
              <!-- <small id="helpId" class="text-muted">Help text</small> -->
            </div>
            <div class="form-group">
              <label for="phone">Phone</label>
              <input type="number" name="phone" id="phone" class="form-control" placeholder="" aria-describedby="helpId">
              <!-- <small id="helpId" class="text-muted">Help text</small> -->
            </div>
            <div class="d-flex">
            <div class="col-6"></div>    
            <div class="col-6"><input type="submit" class="btn btn-outline-info float-right col-lg-12" value="Check Out"></div>
            </div>
        </form>
        </div>
      </div>
    </div>
  </div>
 </div>

{%endblock content%}